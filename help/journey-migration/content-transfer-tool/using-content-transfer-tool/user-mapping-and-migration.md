---
title: ユーザーマッピングとプリンシパルの移行
description: AEM as a Cloud Service でのユーザーマッピングとプリンシパルの移行についての概要です。
exl-id: 4a35fc46-f641-46a4-b3ff-080d090c593b
feature: Migration
role: Admin
source-git-commit: 90f7f6209df5f837583a7225940a5984551f6622
workflow-type: tm+mt
source-wordcount: '1060'
ht-degree: 100%

---

# ユーザーマッピングとプリンシパルの移行 {#user-mapping-and-principal-migration}

>[!CONTEXTUALHELP]
>id="aemcloud_ctt_usermapping"
>title="ユーザーの移行"
>abstract="コンテンツ転送ツールは、ユーザーとグループを既存の Adobe Experience Manager（AEM）システムから AEM as a Cloud Service に移動する際に役に立ちます。 IMS ID を使用してログインできるように、既存のユーザーをマッピングする必要があります。"

>[!NOTE]
>以前のバージョンのユーザーマッピングツールについては、[レガシードキュメント](/help/journey-migration/content-transfer-tool/user-mapping-tool-legacy/considerations-user-mapping-tool-legacy.md)を参照してください。

## はじめに {#introduction}

Adobe Experience Manager（AEM）as a Cloud Service への移行プロセスの一環として、ユーザーとグループ（または「プリンシパル」）を既存の AEM システムから AEM as a Cloud Service に移行する必要があります。このタスクは、コンテンツ転送ツールによって実行されます。

AEM as a Cloud Service の重要な変更の 1 つは、Adobe ID を使用したオーサー層へのアクセスが完全に統合されていることです。このプロセスでは、ユーザーとユーザーグループを管理するために [Adobe Admin Console](https://helpx.adobe.com/jp/enterprise/using/admin-console.html) を使用する必要があります。ユーザープロファイル情報が Adobe Identity Management System（IMS）に一元化され、すべての Adobe クラウドアプリケーションでシングルサインオンを利用できます。詳しくは、[Identity Management](https://experienceleague.adobe.com/docs/experience-manager-cloud-service/content/overview/what-is-new-and-different.html?lang=ja#identity-management) を参照してください。この変更により、既存のユーザーが IMS プロファイルを使用して AEMaaCS にアクセスできるように、既存のユーザーを IMS ID にマッピングする必要があります。従来の AEM のグループは IMS のグループとは基本的に異なるので、グループはマッピングされませんが、移行が完了した後で 2 つのグループセットを調整する必要があります。

## プリンシパル移行の詳細 {#principal-migration-detail}

コンテンツ転送ツールおよび Cloud Acceleration Manager では、移行されるコンテンツに関連付けられているすべてのプリンシパルがクラウドシステムに移行されます。コンテンツ転送ツールは、抽出プロセス中にソース AEM システムからすべてのプリンシパルをコピーすることで、これを行います。次に、CAM 取り込みは、取り込まれるコンテンツに関連付けられたプリンシパルのみを選択して移行します。プリンシパルが移行されたコンテンツの ACL または CUG ポリシー上にある場合、そのプリンシパルとそのプリンシパルが属するすべてのグループ、およびその上位（親）グループがすべて移行されます。さらに、コンテンツのプリンシパルがグループの場合、その下位（子）グループとユーザーもすべて移行されます。

## ユーザーマッピングの詳細 {#user-mapping-detail}

AEM ユーザーは、同じメールアドレスを持つ対応する Adobe IMS ユーザーにマッピングできます。このマッピングは CTT で自動的に行われ（抽出ステップ中）、実行するかどうかは、抽出が開始される前に切替スイッチで制御できます。抽出を開始する際に、ユーザーが切り替えのデフォルト設定を上書きできます。

* ソースシステムがオーサーインスタンスの場合、デフォルトでは、マッピングを行う選択は&#x200B;_オン_&#x200B;になっています。これは、推奨されるプロセスです。
* ソースシステムがパブリッシュインスタンスの場合、デフォルトでは、マッピングを行う選択は&#x200B;_オフ_&#x200B;になっています。ユーザーは通常、パブリッシュインスタンスで移行または使用されないためです。使用される場合は、通常、異なる認証システム（IMS ではない）が使用されます。

ユーザーは、移行されるコンテンツに関連付けられている場合、抽出時にマッピングされているかどうかに関わらず、取り込み時にグループと共にクラウドシステムに移行されます。

## ユーザーをマッピングおよび移行する際の重要な考慮事項 {#important-considerations}

### 例外的な状況 {#exceptional-cases}

次の特定のケースがログに記録されます。

1. ユーザーの *jcr* ノードの `profile/email` フィールドにメールアドレスがない場合、該当するユーザーは移行されますが、マッピングされません。このシナリオは、メールアドレスがログイン時にユーザー名として使用されている場合でも同じです。
2. ユーザーが無効になっている場合、そのユーザーは他のユーザーと同じように扱われ、通常どおりにマッピングおよび移行されて、クラウドインスタンス上では無効のままになります。
3. ソース AEM インスタンスとターゲット AEM Cloud Service インスタンスの両方に同じ一意性制約データ（rep:principalName、rep:authorizableId、jcr:uuid または rep:externalId）のプリンシパルが存在する場合、問題のプリンシパルは移行されず、クラウドシステム上の既存のプリンシパルは変更されません。これは、プリンシパル移行レポートに記録されます。
4. ユーザーがユーザーマッピングを通じて IMS にマッピングされていない場合、クラウド AEM システム上のユーザープロファイルは IMS で認識されません。この場合、IMS 経由でログインすると、AEM 上に新しい（重複）プロファイルが作成されますが、以前のプロファイル情報は含まれません。元のユーザープロファイルはクラウド AEM システム上に存在しますが、IMS 経由でログインできず、従来の AEM 方法（ローカルログイン）のみを使用します。このため、すべてのオーサーの移行には、すべてのユーザーをマッピングすることを強くお勧めします。

## その他の考慮事項 {#additional-considerations}

* 「**取り込み前にクラウドインスタンス上の既存のコンテンツを消去**」オプションが設定されている場合は、以前に Cloud Service インスタンスに転送されたプリンシパルと既存のリポジトリ全体が削除され、コンテンツの取り込み先となる新しいリポジトリが作成されます。このプロセスは、ターゲットの Cloud Service インスタンスの権限を含むすべての設定もリセットします。これは、**管理者**&#x200B;グループに追加された管理者ユーザーにも当てはまります。CTT/CAM 取り込みのアクセストークンを取得するには、管理者ユーザーを&#x200B;**管理者**&#x200B;グループに再度追加する必要があります。
* ワイプなしの取り込みを実行する場合（「**既存のコンテンツを消去**」オプションが設定されていない場合）、前回の転送以降変更がないのでコンテンツが転送されない場合は、そのコンテンツに関連付けられたユーザーやグループも転送されません。このルールは、ユーザーとグループがソースシステム上で変更された場合でも当てはまります。これは、ユーザーやグループの移行が、ユーザーやグループが関連付けられているコンテンツと共にのみ行われるからです。このため、ソースシステム上のグループに新しいプリンシパルは、移行中の別のグループの一部であるか、移行中の別のコンテンツの ACL に含まれていない限り、移行されません。その後、これらのプリンシパルを移行する場合は、パッケージを使用するか、ターゲットからプリンシパルを削除して、関連するコンテンツを再移行することを検討します（上書きありの抽出とワイプありの取り込み）。
* 重複するメールアドレスは IMS では許可されませんが、AEM（オンプレミスとクラウドの両方）では許可されます。ユーザーは、自分のメールアドレスを使用して IMS 経由で AEM にログインでき、IMS で参照されるユーザープロファイルにログインします。
* クローズドユーザーグループ（CUG）ポリシーで使用されるプリンシパルに関するその他の考慮事項について詳しくは、[クローズドユーザーグループの移行](/help/journey-migration/content-transfer-tool/using-content-transfer-tool/closed-user-groups-migration.md)を参照してください。

## 最終概要とレポート {#final-report}

抽出と取り込みが正常に完了すると、プリンシパル移行の詳細を示すレポートが生成されます。詳しくは、[プリンシパルの移行を検証する方法](/help/journey-migration/content-transfer-tool/using-content-transfer-tool/validating-content-transfers.md#how-to-validate-principal-migration)を参照してください。
