---
title: コンテンツの再利用 — マルチサイトマネージャーとライブコピー
description: AEMの強力なライブコピーとマルチサイトマネージャー機能を使用して、コンテンツを再利用する方法を説明します。
feature: マルチサイトマネージャー
role: Administrator
exl-id: 22b4041f-1df9-4189-8a09-cbc0c89fbf2e
source-git-commit: 90de3cf9bf1c949667f4de109d0b517c6be22184
workflow-type: tm+mt
source-wordcount: '2685'
ht-degree: 22%

---

# コンテンツの再利用：マルチサイトマネージャーとライブコピー {#multi-site-manager-and-live-copy}

マルチサイトマネージャー(MSM)を使用すると、同じサイトコンテンツを複数の場所で使用できます。 MSMは、そのライブコピー機能を使用してこれを実現します。

* MSM では、次の操作を実行できます。
   * コンテンツを1回作成してから、
   * 同じサイトまたは他のサイトの他の領域（[ライブコピー](#live-copies)を介して）で、このコンテンツを再利用します。
* その後、MSMはソースコンテンツとそのライブコピーとのライブ関係を次の目的で維持します。
   * ソースコンテンツに変更を加えると、ソースとライブコピーが同期されます。
   * 個々のサブページやコンポーネントのライブ関係を切断することで、ライブコピーのコンテンツのみを調整できます。

このページでは、MSMでのコンテンツの再利用の概要を説明します。 以下のページでは、関連する問題について詳しく説明します。

* [ライブコピーの作成と同期](creating-live-copies.md)
* [ライブコピーの概要コンソール](live-copy-overview.md)
* [ライブコピーの同期の設定](live-copy-sync-config.md)
* [MSM ロールアウトの競合](rollout-conflicts.md)
* [MSM のベストプラクティス](best-practices.md)

## 考えられるシナリオ {#possible-scenarios}

MSMおよびライブコピーの使用例は多数あります。 次のようなシナリオが考えられます。

* **多国籍 - グローバル企業から現地企業**

   MSM がサポートする一般的な使用事例は、複数の多国籍かつ同一言語のサイトにおけるコンテンツの再利用です。これにより、コアコンテンツを再利用しながら、各国のバリエーションも可能になります。

   例えば、[WKNDチュートリアルの英語の節のサンプル](/help/implementing/developing/introduction/develop-wknd-tutorial.md)は、米国のお客様向けに作成されます。 このサイトのコンテンツのほとんどは、様々な国や文化の英語を話す顧客に対応する他のWKNDサイトにも使用できます。 主要なコンテンツは全サイトで同じになる一方で、地域ごとに調整を加えることができます。

   次の構造は、米国およびカナダのサイトで使用できます。 `language-masters`ノードが、英語だけでなく他の言語コンテンツのマスターコピーを維持する方法に注意してください。 このコンテンツは、英語と共に地域の言語コンテンツを追加する際の基礎として使用できます。

   ```xml
   /content
       |- wknd
           |- language-masters
               |- en
               |- es
               |- fr
           |- us
               |- en
               |- es
           |- ca
               |- en
               |- fr
   ```

   >[!NOTE]
   >
   >MSM はコンテンツを翻訳しません。必要な構造を作成し、コンテンツをデプロイするために使用されます。
   >
   >
   >この例については、[多言語サイトのコンテンツの翻訳](/help/sites-cloud/administering/translation/overview.md)を参照してください。

* **国内 - 本社から地方支社**

   また、ディーラーのネットワークを持つ会社は、個々の販売店向けに別々のWebサイトを必要とする場合があります。各Webサイトは、本社が提供する主なサイトのバリエーションです。 これは、複数の支社を持つ単一の企業や、フランチャイズ本部と国内の複数のフランチャイズ加盟店で構成されるフランチャイズシステムに適してします。

   本社が中核となる情報を提供し、各地方の部門が問い合わせ先の詳細情報、営業時間、イベントなどのローカル情報を追加します。

   ```xml
   /content
       |- head-office-berlin
       |- branch-hamburg
       |- branch-stuttgart
       |- branch-munich
       |- branch-frankfurt
   ```

* **複数バージョン**

   MSMでは、特定のサブブランチのバージョンを作成できます。 例えば、サポートサブサイトには、特定の製品の様々なバージョンの詳細を保持できます。この場合、基本情報は一定で、変更が必要なのは更新された機能のみです。

   ```xml
   /content
       |- game-support
           |- polybius
               |- v5.0
               |- v4.0
               |- v3.0
               |- v2.0
               |- v1.0
   ```

   >[!TIP]
   >
   >このシナリオでは、単純なコピーを作成するか、ライブコピーを使用するかのどちらにするかという問題が考えられます。これは、次のバランスです。
   >
   >* 複数のバージョンで更新する必要があるコアコンテンツの量。
   >
   >および
   >
   >* 調整が必要な個々のコピーの量。


## UI からの MSM {#msm-from-the-ui}

MSM は、該当するコンソールの UI から各種オプションを使用して直接アクセスできます。

* **サイトを作成**（**サイト**）

   * MSMを使用すると、共通のコンテンツを共有する複数のWebサイトを管理できます。 例えば、Webサイトは、多くの場合、コンテンツのほとんどがすべての国で共通し、個々の国に固有のコンテンツのサブセットを含むように、国際的なオーディエンス向けに提供されます。 MSMでは、[ソースサイト](creating-live-copies.md#creating-a-live-copy-of-a-site-from-a-blueprint-configuration)に基づいて1つ以上のサイトを自動的に更新するライブコピーを作成できます。 また、共通の基本構造が適用され、複数サイト全体で共通のコンテンツを使用し、共通のルックアンドフィールが保持されるので、サイト間で実際に異なるコンテンツの管理に注力することができます。次の方法でサイトを作成する：
      * ソースの指定に事前に定義されたブループリント設定が必要です。
      * （定義済みの）ソースのライブコピーを作成します。
      * 「**ロールアウト**」ボタンを使用してユーザーを指定します。

* **ライブコピーを作成**（**サイト**）

   * MSMでは、個々のページまたはWebサイトのサブブランチのアドホック（1回限りの）ライブコピーを作成できます。](creating-live-copies.md#creating-a-live-copy-of-a-page)例えば、新しい/更新されたバージョンの製品に関する情報を提供するためにサブブランチを複製します。 [次の方法でライブコピーを作成します。
      * アドホックライブコピーを作成します（ブループリント設定は不要）。
      * 任意のページ/ブランチのライブコピーを（即座に）作成するために使用できます。
      * **同期**&#x200B;が必要です（**ロールアウト**&#x200B;ボタンは提供されません）。

* **プロパティを表示**（**サイト**）

   * 必要に応じて、このオプションを使用して、[ライブコピー](creating-live-copies.md#monitoring-your-live-copy)を監視できます。関連する&#x200B;**ライブコピー**&#x200B;または&#x200B;**ブループリント**&#x200B;に関する情報を提供します。

* **参照**（**サイト**）

   * [参照](/help/sites-cloud/authoring/getting-started/basic-handling.md#references)レールは、**ライブコピー**&#x200B;に関する情報と、適切なアクションへのアクセスを提供します。

* **ライブコピーの概要**（**サイト**）

   * このコンソールを使用すると、ブループリントとそのライブコピーを[表示および管理できます。](live-copy-overview.md)

* **ブループリント**（**ツール**／**サイト**）

   * このコンソールを使用すると、ブループリント設定を[作成および管理できます。](creating-live-copies.md#creating-a-blueprint-configuration)

>[!NOTE]
>
>MSM機能の様々な側面は、ローンチなどの他のAEM機能で使用されます。 この場合、ライブコピーはその機能で管理されます。

### 使用されている用語 {#terms-used}

MSMで使用される主な用語の概要を次の表に示します。これらの詳細については、以降の節およびページで説明します。

| 用語 | 定義 | 詳細 |
|---|---|---|
| ソース | ライブコピーの基礎として使用される元のページ | ブループリントやブループリントページと同義 |
| ライブコピー | ロールアウト設定で定義された同期アクションによって維持される（ソースの）コピー |  |
| ライブコピーの設定 | ライブコピーの設定の詳細の定義 |  |
| ライブの関係 | 特定のリソースの継承の有効な定義（ソースとライブコピー間の接続） | ソースに対する変更をライブコピーと同期できるようにします。 |
| ブループリント | ソースと同義語 | ブループリント設定で定義可能 |
| ブループリント設定 | ソースパスを指定する事前定義済みの設定 | ブループリント設定でブループリントページが参照されると、「ロールアウト」コマンドが使用可能になります |
| 第 章 | ライブコピーに含めるブループリントのセクション | 通常、これらはルートのサブページです |
| 同期化 | ソースとライブコピーの間のコンテンツの同期を表す一般的な用語（**ロールアウト**&#x200B;と&#x200B;**同期**&#x200B;オプションの両方） |  |
| ロールアウト | ソースからライブコピーに同期 | 作成者（ブループリントページ上）またはシステムイベント（ロールアウト設定で定義）によってトリガーされます。 |
| ロールアウト設定 | 同期するプロパティと同期の方法およびタイミングを決定するルール |  |
| 同期 | ライブコピーページから手動で行われる同期リクエスト |  |
| 継承 | 同期が発生すると、ライブコピーのページ/コンポーネントはソースのページ/コンポーネントからコンテンツを継承します |  |
| 休止 | ライブコピーとそのブループリントページの間のライブ関係を一時的に削除する |  |
| 分離 | ライブコピーとそのブループリントページの間のライブ関係を完全に削除する |  |
| リセット | ライブコピーページをリセットして、すべての継承のキャンセルを削除し、ページをソースページと同じ状態に戻す | リセットは、ページプロパティ、段落システムおよびコンポーネントに対して行った変更に影響します。 |
| シャロー | 単一ページのライブコピー |  |
| ディープ | ページのライブコピーとその子ページ |  |

<!--
>[!TIP]
>
>See [Overview of the Java API](/help/sites-developing/extending-msm.md#overview-of-the-java-api) for the object names.
-->

## ライブコピー {#live-copies}

MSMライブコピーは、特定のサイトコンテンツのコピーです。このコピーについては、元のソースとのライブ関係が維持されます。

* ライブコピーはソースからコンテンツを継承します。
* ソースに対して変更が加えられると、同期化によってコンテンツが実際に転送されます。
* ライブコピーは、次のいずれかと見なすことができます。
   * シャロー：単一のページ
   * ディープ：ページとその子ページ
* 同期ルール（ロールアウト設定と呼ばれます）は、同期するプロパティと同期の発生時期を決定します。

前の例では、`/content/wknd/language-masters/en`は英語のグローバルマスターサイトです。 このサイトのコンテンツを再利用するために、MSMライブコピーが作成されます。

* `/content/wknd/language-masters/en`の下のコンテンツがソースです。
* `/content/wknd/language-masters/en`の下のコンテンツは、`/content/wknd/us/en/`ノードと`/content/wknd/ca/en`ノードの下にコピーされます。 ライブコピーです。
* 作成者は`/content/wknd/language-masters/en`の下のページに変更を加えます。
* トリガーされると、MSMはこれらの変更をライブコピーに同期します。

### ライブコピー - 構成 {#live-copies-composition}

>[!NOTE]
>
>この節の図と説明は、潜在的なライブコピーのスナップショットを表しています。 これらは包括的ではなく、特徴を説明するための概要を示しています。

ライブコピーを最初に作成すると、選択したソースページがライブコピーに1:1ベースで反映されます。 その後、新しいリソース（ページや段落）をライブコピー内で直接作成することもできるので、これらのバリエーションと同期への影響を把握しておくと役に立ちます。 使用可能な構成は次のとおりです。

* [ライブコピー以外のページのライブコピー](#live-copy-with-non-live-copy-pages)
* [ネストされたライブコピー](#nested-live-copies)

ライブコピーの基本的な形式は次のとおりです。

* 選択したソースページを1対1で反映するライブコピーページ。
* 1 つの設定定義。
* すべてのリソースに定義されているライブ関係。
   * ライブコピーリソースをそのブループリント/ソースにリンクします。
   * 継承とロールアウトを実現する際に使用されます。

変更は、要件に応じて[同期](creating-live-copies.md#synchronizing-your-live-copy)できます。

![ライブコピーの構成の概要](../assets/live-copy-composition.png)

#### ライブコピー以外のページのライブコピー{#live-copy-with-non-live-copy-pages}

AEMでライブコピーを作成すると、ライブコピーのブランチを表示および移動して、ライブコピーのブランチで通常のAEM機能を使用できます。 つまり、ユーザー（またはプロセス）は、ライブコピー内に新しいリソース（ページや段落）を作成できます。 例：特定の地域や国向けの製品。

* そのようなリソースにはソースやブループリントのページへのライブ関係がなく、同期されません。
* このシナリオは、MSM が特殊なケースを処理する場合に発生することがあります。例えば、ユーザー（またはプロセス）がソース/ブループリントとライブコピーのブランチの両方で同じ位置と名前のページを作成する場合などです。 このような状況について詳しくは、[MSMロールアウトの競合](rollout-conflicts.md)を参照してください。

![ライブコピー以外のページのライブコピー](../assets/live-copy-with-non-live-copy-pages.png)

#### ネストされたライブコピー {#nested-live-copies}

既存のライブコピー](#live-copy-with-non-live-copy-pages)内に[新しいページを作成する場合、この新しいページは別のブループリントのライブコピーとして設定することもできます。 これはネストされたライブコピーと呼ばれます。 ネストされたライブコピーでは、2番目または内部のライブコピーの動作は、次の方法で最初または外部のライブコピーの影響を受けます。

* トップレベルのライブコピーに対してトリガーされたディープロールアウトは、ネストされたライブコピー内に続行できます。
* ソース間のリンクは、ライブコピー内で書き換えられます。

例えば、2番目のブループリントから最初のブループリントを指すリンクは、ネストされた2番目のライブコピーから最初のライブコピーを指すリンクとして書き換えられます。

![ネストされたライブコピー](../assets/live-copy-nested.png)

>[!NOTE]
>
>ライブコピーの分岐内でページを移動または名前変更すると、これはネストされたライブコピーとして扱われ、AEMで関係を追跡できます。

#### 積み重ねられたライブコピー {#stacked-live-copies}

ライブコピーは、シャローライブコピーの子として作成される場合、スタックされたライブコピーと呼ばれます。 これは、[ネストされたライブコピー](#nested-live-copies)と同じ方法で動作します。

### ソース、ブループリントおよびブループリント設定 {#source-blueprints-and-blueprint-configurations}

任意のページまたはページのブランチをライブコピーのソースとして使用できます。 ただし、MSM ではソースパスを指定するブループリント設定も定義できます。ブループリント設定を使用する利点は、次のとおりです。

* 作成者がブループリントで&#x200B;**ロールアウト**&#x200B;オプションを使用できるようにします。 例えば、このブループリントから継承されるライブコピーに変更を明示的にプッシュします。
* 作成者が&#x200B;**サイトを作成**&#x200B;を使用できるようにします。これにより、ユーザーは簡単に言語を選択し、ライブコピーの構造を設定できます。
* ブループリントと関係のあるライブコピーのデフォルトのロールアウト設定を定義します。

ライブコピーのソースは、通常のページまたはブループリント設定に含まれるページのいずれかにできます。どちらも有効な使用例です。

ソースがライブコピーのブループリントを形成します。 ブループリントは次のいずれかをおこなうと定義されます。

* [ブループリント設定を作成](creating-live-copies.md#creating-a-blueprint-configuration)  — この設定は、ライブコピーの作成に使用するページを事前に定義します。
* [ページのライブコピーを作成](creating-live-copies.md#creating-a-live-copy-of-a-page)  — ライブコピーの作成に使用するページ（ソースページ）はブループリントページです。ソースページは、ブループリント設定で参照される場合と参照されない場合があります。

### ロールアウトと同期 {#rollout-and-synchronize}

ロールアウトは、ライブコピーをソースと同期する中央のMSMアクションです。 ロールアウトは手動で実行することも、自動で実行することもできます。

* [ロールアウト設定](#rollout-configurations)を定義して、特定の[イベント](live-copy-sync-config.md#rollout-triggers)がルートのロールアウトを自動的に引き起こすように設定できます。
* ブループリントページのオーサリング時に、**[ロールアウト](creating-live-copies.md#rolling-out-a-blueprint)**&#x200B;コマンドを使用して、変更をライブコピーにプッシュできます。
   * **ロールアウト**&#x200B;コマンドは、ブループリント設定で参照されるブループリントページで使用できます。

   ![ロールアウト](../assets/live-copy-rollout.png)

* ライブコピーページのオーサリング時に、**[同期](creating-live-copies.md#synchronizing-a-live-copy)**&#x200B;コマンドを使用して、ソースからライブコピーに変更を取り込むことができます。
   * **同期**&#x200B;コマンドは、ソース/ブループリントページがブループリント設定に含まれているかどうかに関係なく、ライブコピーページで常に使用できます。

   ![同期](../assets/live-copy-synchronize.png)

### ロールアウト設定 {#rollout-configurations}

ロールアウト設定は、ライブコピーをソースコンテンツと同期するタイミングと方法を定義します。 ロールアウト設定は、トリガーと 1 つ以上の同期アクションで構成されます。

* **トリガー** -トリガーは、ライブアクションの同期（ソースページのアクティベーションなど）を発生させるイベントです。 MSM では、使用可能なトリガーを定義します。
* **同期アクション**  — 同期アクションは、ライブコピーで実行され、ソースと同期されます。アクションの例としては、コンテンツのコピー、子ノードの並べ替え、ライブコピーページのアクティベートがあります。 MSMには、多数の同期アクションが用意されています。

>[!NOTE]
>
>Java API を使用してお使いのインスタンスのカスタムアクションを作成できます。

ロールアウト設定は再利用できるので、複数のライブコピーで同じロールアウト設定を使用できます。 標準のインストールにいくつかの[ロールアウト設定](live-copy-sync-config.md#installed-rollout-configurations)が含まれています。

### ロールアウトの競合  {#rollout-conflicts}

特に、作成者がソースとライブコピーの両方でコンテンツを編集している場合、ロールアウトが複雑になる可能性があります。したがって、ロールアウト中に発生する可能性のある[競合の処理方法をAEMが把握しておくと便利です。](rollout-conflicts.md)

### 継承と同期の休止とキャンセル {#suspending-and-cancelling-inheritance-and-synchronization}

ライブコピー内の各ページとコンポーネントは、ライブ関係を介してソースページとコンポーネントに関連付けられます。 ライブ関係は、ソースからのライブコピーコンテンツの同期を設定します。

ライブコピーページのライブコピーの継承を&#x200B;**休止**&#x200B;して、ページのプロパティやコンポーネントを変更できます。 継承を休止すると、ページプロパティとコンポーネントがソースと同期されなくなります。

個々のページの編集時に、作成者はコンポーネントの&#x200B;**継承をキャンセル**&#x200B;できます。継承がキャンセルされると、ライブの関係が休止状態になり、そのコンポーネントの同期はおこなわれません。継承と同期のキャンセルは、コンテンツのサブセクションをカスタマイズする必要がある場合に役立ちます。

### ライブコピーの分離 {#detaching-a-live-copy}

[ライブコピー](creating-live-copies.md#detaching-a-live-copy)をブループリントから分離して、すべての接続を削除することもできます。

>[!CAUTION]
>
>分離アクションは永続的で元に戻すことはできません。

分離アクションは、ライブコピーとそのブループリントページの間のライブ関係を完全に削除します。 MSM関連のすべてのプロパティがライブコピーから削除され、ライブコピーページはスタンドアロンコピーになります。

>[!TIP]
>
>サブページと親ページに対する関連する影響など、詳しくは、 [ライブコピーの分離](creating-live-copies.md#detaching-a-live-copy)を参照してください。

## MSM を使用するための標準的な手順 {#standard-steps-for-using-msm}

以下の手順は、MSMを使用してコンテンツを再利用し、変更をライブコピーに同期するための標準的な手順を示しています。

1. ソースサイトのコンテンツを作成します。
1. 使用するロールアウト設定を決定します。

   1. MSM [では、複数の使用例を満たす複数のロールアウト設定](live-copy-sync-config.md#installed-rollout-configurations)をインストールします。
   1. 必要に応じて、[ロールアウト設定を作成](live-copy-sync-config.md#creating-a-rollout-configuration)できます。

1. [使用するロールアウト設定を指定する](live-copy-sync-config.md#specifying-the-rollout-configurations-to-use)場所を決定し、必要に応じて設定をおこないます。
1. 必要に応じて、ライブコピーのソースコンテンツを識別するブループリント設定[を作成します。](creating-live-copies.md#creating-a-blueprint-configuration)
1. [ライブコピーを作成します。](creating-live-copies.md#creating-a-live-copy)
1. 必要に応じてソースコンテンツを変更します。組織で確立されている通常のコンテンツのレビュー／承認プロセスを採用してください。
1. [ブループ](creating-live-copies.md#rolling-out-a-blueprint) リントをロールアウトする [か、ライブコピーを変](creating-live-copies.md#synchronizing-a-live-copy) 更と同期します。

## MSM のカスタマイズ {#customizing-msm}

MSM には、コンテンツの共有時に発生する可能性のある例外的な複雑さに実装を対応させるためのツールが用意されています。

* **カスタムロールアウト設定**  — イ [ンストールされ](live-copy-sync-config.md#creating-a-rollout-configuration) たロールアウト設定が要件を満たさない場合に、ロールアウト設定を作成します。有効な任意のロールアウトトリガーおよび同期アクションを使用できます。

<!--
* **Custom Synchronization Actions** - [Create a custom synchronization action](/help/sites-developing/extending-msm.md#creating-a-new-synchronization-action) when the installed actions do not meet your specific application requirements. MSM provides a Java API for creating custom synchronization actions.
-->

## ベストプラクティス {#best-practices}

[MSM のベストプラクティス](best-practices.md)には、実装に関する重要な情報が記載されています。
