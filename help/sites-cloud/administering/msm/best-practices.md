---
title: MSM のベストプラクティス
description: AEM Multi Site Managerの使い始めるのに役立つ、Adobeエンジニアリングチームとコンサルティングチームがコンパイルしたベストプラクティスについて説明します。
feature: マルチサイトマネージャー
role: Administrator
exl-id: 61b8ded8-3b9e-423f-85a9-7280e1a721cc
source-git-commit: 184de9c1391ade3abbf2c6d73f09a324e6fa7e3e
workflow-type: tm+mt
source-wordcount: '1436'
ht-degree: 32%

---

# MSM のベストプラクティス {#msm-best-practices}

## 一般 {#general}

MSM は、コンテンツのデプロイメントを自動化するための設定可能なフレームワークです。多くの場合、実装は Web サイトの主要な部分に影響を及ぼし、複数の組織や地域にわたっておこなわれます。そのため、Web サイトの計画時と同様に、最大限の注意を払って MSM の実装を計画することを強くお勧めします。

* 実装を開始する前に、慎重に&#x200B;**計画構造とコンテンツフロー**&#x200B;を計画します。
* **最小限必要なカスタマイズだけをおこなってください。** MSMは高度なカスタマイズ（ロールアウト設定など）をサポートしていますが、通常、Webサイトのパフォーマンス、信頼性、アップグレード性のベストプラクティスは、カスタマイズを最小限に抑えることです。
* **ガバナンス**&#x200B;モデルを早期に確立し、成功を確実に得るために適切な方法でユーザーをトレーニングします。 ガバナンスの観点からのベストプラクティスは、他のローカルユーザーとそれぞれのライブコピーにコンテンツを割り当て/接続するために、ローカルコンテンツ作成者が持つ権限&#x200B;**を最小限に抑えることです。**&#x200B;これは、非管理型の連鎖的な継承は、MSM構造の複雑さを大幅に増し、パフォーマンスと信頼性を損なう可能性があるからです。
* 構造、コンテンツフロー、自動化、ガバナンスの計画が作成されたら、**プロトタイプを作成し、実稼動環境の実装を開始する前に、システム**&#x200B;を十分にテストします。
* **Adobeコンサルティングと主要なシステムインテグレーター**&#x200B;は、MSMを使用したコンテンツの自動化の計画と実装に関する深い経験を持つので、MSMプロジェクトの開始と実装全体を支援できます。

## ライブコピーのソースとブループリント設定 {#live-copy-sources-and-blueprint-configurations}

ライブコピーは、[通常のページ](creating-live-copies.md#creating-a-live-copy-of-a-page)または[ブループリント設定](creating-live-copies.md#creating-a-live-copy-of-a-site-from-a-blueprint-configuration)を使用して作成できます。 どちらも有効なソースです。

ブループリント設定を使用する追加の利点は次のとおりです。

* 作成者がブループリントで&#x200B;**ロールアウト**&#x200B;オプションを使用して、このブループリントから継承するライブコピーに変更を明示的にプッシュできるようにします。
* 言語の選択とライブコピーの構造の設定を容易におこなえるように、作成者が「**サイトを作成**」を使用できるようにします。
* ブループリントと関係のあるライブコピーのデフォルトのロールアウト設定を定義します。

ブループリント設定が参照されていない場合、ロールアウトはライブコピー自体からのみ開始でき、基本的にはソースからコンテンツを取り込みます。

ライブコピーを使用して新しいサイトを作成する場合は、MSMの機能セット全体を確実に使用できるように、ブループリント設定を作成すると便利です。

>[!NOTE]
>
> 「権限」タブのCUGは、ブループリントからライブコピーにロールアウトできません。 ライブコピーを設定する際には、この点を考慮してください。

## コンポーネントとコンテナの同期 {#components-and-container-synchronization}

一般に、コンポーネントの同期に関する MSM のロールアウトルールは、次のとおりです。

* コンポーネントは、ブループリントに含まれるリソースを同期してロールアウトされます。
* コンテナは、現在のリソースのみを同期します。

これは、コンポーネントが集計として扱われ、ロールアウトでは、コンポーネント自体およびそのすべての子がブループリントのものと置き換えられることを意味します。これは、リソースがそのようなコンポーネントにローカルで追加されると、ロールアウト時にブループリントのコンテンツでなくなることを意味します。

コンポーネントのネストをサポートするには、そうしたローカルで追加されたコンポーネントがロールアウトで維持され、そのコンポーネントがコンテナとして宣言される必要があります。

>[!NOTE]
>
>プロパティ `cq:isContainer` をコンポーネントに追加し、コンテナとして指定します。

## サイトの作成 {#create-site}

AEMには、ライブコピーを作成するための主な方法が2つあります。

* [ライブコピー](creating-live-copies.md#creating-a-live-copy-of-a-page)の作成時 — これは、より一般的なアプローチと見なすことができ、任意のページからライブコピーを作成できます。 ライブコピーのコンテンツ構造は、ソースと完全に一致します。

* [サイトの作成](creating-live-copies.md#creating-a-live-copy-of-a-site-from-a-blueprint-configuration)の場合 — 主に多言語構造のWebサイトを作成する場合の、より特殊なアプローチです。

サイトを作成する際に注意すべきいくつかの点を以下に示します。

* 新しいサイトを作成するには、[ブループリント設定](creating-live-copies.md#managing-blueprint-configurations)が必要です。
* 新しいサイトに作成する言語パスの選択を許可するには、対応する言語ルートがブループリント（ソース）に存在する必要があります。
* [新しいサイトをライブコピー](creating-live-copies.md#creating-a-live-copy-of-a-site-from-a-blueprint-configuration)として作成（**作成**&#x200B;を使用）した後、**サイト**&#x200B;を使用)すると、このライブコピーの最初の2つのレベルは&#x200B;*シャロー*&#x200B;になります。 ページの子はライブ関係には属しませんが、トリガーに一致するライブ関係が見つかった場合には引き続きロールアウトが引き継がれます。

以下を回避すると便利です。

* ブループリント（第1レベル以下）に言語を手動で追加する。
* 言語ルートの直下にコンテンツを手動で追加しても、ロールアウト時にこの新しいコンテンツがライブコピーに自動的に引き継がれることはありません。

## MSM と多言語の Web サイト {#msm-and-multilingual-websites}

MSM は、次の 2 つの方法で多言語 Web サイトを作成するために役立ちます。

言語マスターを作成する際は、次の点に注意してください。

* MSM 自体に&#x200B;**コンテンツ翻訳機能は備わっていません**&#x200B;が、翻訳に対応したサードパーティの翻訳コネクターと統合できます。次の点に留意してください。
   * MSMでは、ページやコンポーネントレベルで継承をキャンセルできます。 これにより、次回のロールアウト時に（ライブコピーの）翻訳済みコンテンツがブループリントの未翻訳コンテンツで上書きされるのを防ぐことができます。
      * 一部のサードパーティの翻訳コネクターでは、この MSM の継承の管理が自動化されます。
      * 詳しくは、翻訳サービスプロバイダーにお問い合わせください。
      * 言語マスターを作成して翻訳する代わりに、言語コピーを AEM の標準翻訳統合フレームワークと組み合わせて使用することもできます。

詳しくは、[多言語サイトのコンテンツの翻訳](/help/sites-cloud/administering/translation/overview.md)および[翻訳のベストプラクティスを参照してください。](/help/sites-cloud/administering/translation/best-practices.md)

## 構造の変更とロールアウト {#structure-changes-and-rollouts}

ブループリント/ソースツリーのコンテンツ構造に対する変更は、ライブコピーには反映されません。 これは、変更の内容によって変わります。

* **** ブループリントに新しいページを作成すると、標準のロールアウト設定を使用したロールアウト後に、対応するページがライブコピーに作成されます。
* **** ブループリント内のページを削除すると、標準のロールアウト設定を使用したロールアウト後に、対応するページがライブコピーから削除されます。
* **** ブループリント内のページを移動し **** ても、標準のロールアウト設定を使用したロールアウト後に、対応するページがライブコピー内で移動されることはありません。
   * この動作になる理由は、ページの移動にはページの削除が暗黙的に含まれているからです。オーサー上のページを削除すると、パブリッシュ上の対応するコンテンツが自動的に非アクティブ化されるので、パブリッシュ時に予期しない動作が発生する可能性があります。 また、リンクやブックマークなど、関連する項目に対しても影響を与える可能性があります。
      * 各ライブコピーページのコンテンツの継承が更新され、ソースの新しい場所がブループリントに反映されます。
      * ブループリントからライブコピーへのページ移動を完全に実現するには、[ページ移動のベストプラクティスを検討してください。](#page-move)

### ページ移動のベストプラクティス{#page-move}

ライブコピー内のページの移動を検討する際は、次のベストプラクティスを検討してください。

>[!NOTE]
>
>次の操作は、[ロールアウト時トリガー](live-copy-sync-config.md#rollout-triggers)でのみ機能します。

1. カスタムロールアウト設定を作成します。
   * この新しい設定には、アクション`PageMoveAction`を含める必要があります。
   * この設定に他のアクションを追加しないでください。
1. 新しい設定を配置します。
   * ライブコピー内の古い場所にある各ページを削除しながら、ページ移動を完全にロールアウトするには：
      * 新規に作成した設定を標準ロールアウト設定の前に配置します。標準のロールアウト設定では、古い場所にあるページの削除が処理されます。
      * ライブコピー内の古い場所に各ページを保持したまま、ページ移動をロールアウトする（基本的にはコンテンツの複製）には：
         * 新規に作成した設定を標準ロールアウト設定の後に配置します。これにより、ライブコピー内のコンテンツが削除されたり、パブリッシュからアクティベートが解除されたりすることはありません。

## ロールアウトのカスタマイズ {#customizing-rollouts}

MSM のロールアウト設定は高度なカスタマイズが可能です。ロールアウトの自動化は広範囲に影響を及ぼす場合があります。ベストプラクティスとして、次のアクティビティに取り組む前に、十分に注意深く計画する必要があります。

* [onModifyトリガー](#onmodify)を使用したロールアウトの自動化
* [ノードタイプ/プロパティ](#node-types-properties)のカスタマイズ
* 後続のワークフローの開始
* ロールアウトの一部としてのコンテンツのアクティブ化

### onModify {#onmodify}

[ロールアウトトリガー](live-copy-sync-config.md#rollout-triggers) `onModify` を使用する際には、次の点に留意してください。

* `onModify`トリガーを使用したロールアウトの自動化は、ページを変更するたびにロールアウトがトリガーされるので、オーサリングのパフォーマンスに悪影響を与える可能性があります。
* ロールアウト結果は、次のように予想に反する場合があります。
   * 実行される変更イベントの順序は指定できません。
   * イベントベースのアーキテクチャでは、ロールアウトマネージャーに渡されるイベントの順序は保証されません。
* このようなロールアウト設定を使用すると、同じリソースの同時更新が発生した場合にコミットが競合する可能性があります。

したがって、`onModify`トリガーを使用するのは、自動ロールアウトの開始のメリットが潜在的なパフォーマンスの問題を上回る場合のみにすることをお勧めします。

### ノードタイプ／プロパティ {#node-types-properties}

MSMでは、ロールアウトアクションのカスタマイズに加えて、ロールアウトするノードプロパティをカスタマイズすることもできます。 [MSM OSGi設定を使用すると、ソースからライブコピーにコピーされるノードタイプ](live-copy-sync-config.md#excluding-properties-and-node-types-from-synchronization)を除外できます。

## その他の情報 {#further-information}

MSMとライブコピーについて詳しくは、次の記事を参照してください。

* [ライブコピーの作成と同期](creating-live-copies.md)
* [ライブコピーの概要コンソール](live-copy-overview.md)
* [ライブコピーの同期の設定](live-copy-sync-config.md)
* [MSM ロールアウトの競合](rollout-conflicts.md)
