---
title: エクスペリエンスフラグメント
description: Adobe Experience Manager as a Cloud Service のエクスペリエンスフラグメントを使用して、エクスペリエンスの再利用性と柔軟性を高めます。
exl-id: 9dc33677-141f-47e5-a01e-6c7488686314
solution: Experience Manager Sites
feature: Authoring, Experience Fragments
role: User
source-git-commit: 5578cfd1bbe91d904d3f36b67acf610f9196cb7d
workflow-type: ht
source-wordcount: '2142'
ht-degree: 100%

---

# エクスペリエンスフラグメント {#experience-fragments}

Adobe Experience Manager as a Cloud Service 内では、エクスペリエンスフラグメントは、

* 1 つ以上のコンポーネントのグループです。
* コンテンツとレイアウトの両方を含んでいます。
* ページ内で参照可能です。
* 任意のコンポーネントを含めることができます。

エクスペリエンスフラグメントは、

* エクスペリエンス（ページ）の一部です。
* （編集可能なテンプレートに基づいた）複数のページで使用できます。
* 構造とコンポーネントを定義するためのテンプレート（編集のみ可能）に基づいています。
* このテンプレートは、エクスペリエンスフラグメントの&#x200B;*ルートページ*&#x200B;の作成に使用されます。
* 段落システム内に、レイアウトを含む 1 つ以上のコンポーネントで構成されています。
* その他のエクスペリエンスフラグメントを含めることができます。
* その他のコンポーネント（その他のエクスペリエンスフラグメントを含む）と組み合わせて、完全なページ（エクスペリエンス）を形成できます。
* ルートページに基づいて、1 つ以上のバリエーションを作成できます。
* これらのバリエーションでは、コンテンツやコンポーネントを共有できます。
* フラグメントの複数のバリエーションで使用できる構築ブロックに分類できます。

エクスペリエンスフラグメントを使用できるのは、次の場合です。

* 作成者がページの一部（エクスペリエンスのフラグメント）を再利用する場合。
エクスペリエンスフラグメントを使用しなければ、作成者はそのフラグメントをコピーして貼り付ける必要があります。これらのエクスペリエンスのコピー／貼り付けの作成と管理には時間がかかり、ユーザーエラーが発生しがちです。
エクスペリエンスフラグメントは、コピー／貼り付けを不要にします。
* ヘッドレス CMS の使用例をサポートする場合。
作成者は AEM をオーサリングにのみ使用し、顧客への配信には使用しないようにします。サードパーティシステム／タッチポイントは、そのエクスペリエンスを使用してユーザーに配信します。
* [マルチサイト管理（MSM）](/help/sites-cloud/administering/msm/overview.md)を対象とする場合。エクスペリエンスフラグメントがページの一部だからです。これは、個々のフラグメントと、それらが存在するフォルダーの両方に当てはまります。

>[!NOTE]
>
>**[コンテンツフラグメント](/help/sites-cloud/authoring/fragments/content-fragments.md)**&#x200B;と&#x200B;**エクスペリエンスフラグメント**&#x200B;は、AEM 内の異なる機能です。
>* **コンテンツフラグメント**&#x200B;は、定義と構造を備えたエディトリアルコンテンツですが、視覚的なデザインやレイアウトは追加されていません。コンテンツフラグメントを使用すれば、テキスト、数値、日付などの構造化データにアクセスできます。
>* **エクスペリエンスフラグメント**&#x200B;は完全にレイアウトされたコンテンツであり、web ページのフラグメントです。
>
>エクスペリエンスフラグメントには、コンテンツフラグメントの形式でコンテンツを含めることができますが、その逆はできません。
>
>詳しくは、[AEM のコンテンツフラグメントとエクスペリエンスフラグメントについて](https://experienceleague.adobe.com/docs/experience-manager-learn/sites/content-fragments/understand-content-fragments-and-experience-fragments.html?lang=ja#content-fragments)を参照してください。

>[!NOTE]
>
>エクスペリエンスフラグメントの書き込みアクセス権には、次のグループに登録されたユーザーアカウントが必要です。
>
>* `experience-fragments-editors`
>
>問題が発生している場合は、システム管理者にお問い合わせください。

## エクスペリエンスフラグメントを使用するタイミング？ {#when-should-you-use-experience-fragments}

エクスペリエンスフラグメントは、次の場合に使用します。

* エクスペリエンスを再利用する場合。
   * 同じコンテンツや類似のコンテンツで再利用されるエクスペリエンス。
* AEM をサードパーティのコンテンツ配信プラットフォームとして使用する場合。
   * AEM をコンテンツ配信プラットフォームとして使用するソリューション.
   * サードパーティのタッチポイントへのコンテンツの埋め込み。
* 異なるバリエーションやレンディションを持つエクスペリエンスがある場合。
   * チャネル固有またはコンテキスト固有のバリエーション.
   * グループに対応したエクスペリエンス（チャネル間でエクスペリエンスが異なるキャンペーンなど）
* オムニチャネルコマースを使用する場合。
   * タッチポイントのトランザクション化。

## エクスペリエンスフラグメントの整理 {#organizing-your-experience-fragments}

以下をお勧めします。
* フォルダーを使用してエクスペリエンスフラグメントを整理する。

* [これらのフォルダーで使用可能なテンプレートを設定する](#configure-allowed-templates-folder)。

フォルダーを作成すると、次の操作が可能になります。

* エクスペリエンスフラグメントにとって意味のある構造（例：分類に従った構造）を作成する。

  >[!NOTE]
  >
  >エクスペリエンスフラグメントの構造をサイトのページ構造に合わせる必要はありません。

* [許可されたテンプレートをフォルダーレベルで割り当てる。](#configure-allowed-templates-folder)

  >[!NOTE]
  >
  >[テンプレートエディター](/help/sites-cloud/authoring/page-editor/templates.md)を使用すると、独自のテンプレートを作成できます。

WKND プロジェクトでは、`Contributors` に従って一部のエクスペリエンスフラグメントを構造化します。また、使用される構造は、マルチサイト管理（言語コピーを含む）などの他の機能の使用方法の例も示します。

以下を参照してください。

`http://localhost:4502/aem/experience-fragments.html/content/experience-fragments/wknd/language-masters/en/contributors/kumar-selveraj/master`

![エクスペリエンスフラグメントのフォルダー](/help/sites-cloud/authoring/assets/xf-folders.png)

## エクスペリエンスフラグメントのフォルダーの作成と設定 {#creating-and-configuring-a-folder-for-your-experience-fragments}

エクスペリエンスフラグメントのフォルダーを作成および設定するには、次の操作をお勧めします。

1. [フォルダーを作成](/help/sites-cloud/authoring/sites-console/managing-pages.md#creating-a-new-folder) します。

1. [そのフォルダーに使用できるエクスペリエンスフラグメントテンプレートを設定](#configure-allowed-templates-folder)します。

>[!NOTE]
>
>また、[インスタンスに使用できるテンプレート](#configure-allowed-templates-instance)を設定することもできますが、アップグレード時に値が上書きされる可能性があるので、この方法は&#x200B;**お勧めしません**。

### フォルダーに使用できるテンプレートの設定 {#configure-allowed-templates-folder}

>[!NOTE]
>
>アップグレード時に値が上書きされないので、「**許可されたテンプレート**」を指定する場合は、この方法をお勧めします。

1. 必要な&#x200B;**エクスペリエンスフラグメント**&#x200B;フォルダーに移動します。

1. フォルダーを選択してから、「**プロパティ**」を選択します。

1. 必要なテンプレートを取得するための正規表現を「**許可されたテンプレート**」フィールドに指定します。

   次に例を示します。
   `/conf/(.*)/settings/wcm/templates/experience-fragment(.*)?`

   以下を参照してください。
   `http://localhost:4502/mnt/overlay/cq/experience-fragments/content/experience-fragments/folderproperties.html/content/experience-fragments/wknd`

   ![エクスペリエンスフラグメントのプロパティ - 許可されたテンプレート](/help/sites-cloud/authoring/assets/xf-folders-templates.png)

   >[!NOTE]
   >
   >詳しくは、[エクスペリエンスフラグメントのテンプレート](/help/implementing/developing/extending/experience-fragments.md#templates-for-experience-fragments)を参照してください。

1. 「**保存して閉じる**」を選択します。

### インスタンスに使用できるテンプレートの設定 {#configure-allowed-templates-instance}

>[!CAUTION]
>
>指定したテンプレートがアップグレード時に上書きされる可能性があるので、「**許可されたテンプレート**」をこの方法で変更することはお勧めしません。
>
>このダイアログボックスは、情報提供のみを目的として使用します。

1. 必要な&#x200B;**エクスペリエンスフラグメント**&#x200B;コンソールに移動します。

1. 「**設定オプション**」を選択します。

   ![設定ボタン](/help/sites-cloud/authoring/assets/xf-18.png)

1. **エクスペリエンスフラグメントを設定**&#x200B;ダイアログで、必要なテンプレートを指定します。

   ![エクスペリエンスフラグメントを設定](/help/sites-cloud/authoring/assets/xf-19.png)

   >[!NOTE]
   >
   >詳しくは、[エクスペリエンスフラグメントのテンプレート](/help/implementing/developing/extending/experience-fragments.md#templates-for-experience-fragments)を参照してください。

1. 「**保存**」を選択します。

## エクスペリエンスフラグメントの作成 {#creating-an-experience-fragment}

エクスペリエンスフラグメントを作成するには、次の手順に従います。

1. グローバルナビゲーションから「**エクスペリエンスフラグメント**」を選択します。

   ![ナビゲーションパネルのエクスペリエンスフラグメント](/help/sites-cloud/authoring/assets/xf-01.png)

1. 目的のフォルダーに移動し、「**作成**」をクリックします。

   ![エクスペリエンスフラグメントのフォルダーの作成](/help/sites-cloud/authoring/assets/xf-02.png)

1. 「**エクスペリエンスフラグメント**」を選択して、**エクスペリエンスフラグメントを作成**&#x200B;ウィザードを開きます。

   適切な&#x200B;**テンプレート**&#x200B;を選択して、「**次へ**」を選択します。

   ![エクスペリエンスフラグメントテンプレートの選択](/help/sites-cloud/authoring/assets/xf-03.png)


1. **エクスペリエンスフラグメント**&#x200B;の&#x200B;**プロパティ**&#x200B;を入力します。

   **タイトル**&#x200B;は必須です。**名前**&#x200B;が空欄のままの場合は、**タイトル**&#x200B;から派生します。

   ![エクスペリエンスフラグメントのプロパティ](/help/sites-cloud/authoring/assets/xf-04.png)

   >[!NOTE]
   >
   >エクスペリエンスフラグメントテンプレート内のタグは、このエクスペリエンスフラグメントルートページのタグとは結合されません。
   >
   >これらは完全に別個のものです。

1. 「**作成**」をクリックします。

   メッセージが表示されます。選択:

   * 「**完了**」を選択すると、コンソールに戻ります。
   * 「**開く**」を選択すると、フラグメントエディターを開きます。

## エクスペリエンスフラグメントの編集 {#editing-your-experience-fragment}

エクスペリエンスフラグメントエディターには、通常のページエディターと似た機能があります。

>[!NOTE]
>
>ページエディターの使用方法についての詳細情報は、[ページコンテンツの編集](/help/sites-cloud/authoring/page-editor/edit-content.md)を参照してください。

次の手順の例では、商品のティーザーを作成する方法を示しています。

1. 必要なコンポーネントを[コンポーネントブラウザー](/help/sites-cloud/authoring/page-editor/editor-side-panel.md#components-browser)からドラッグ＆ドロップします。

1. コンポーネントに応じて以下を行います。
   * コンテンツやアセットを必要に応じて追加します。
   * プロパティを必要に応じて設定します。

1. 必要に応じてその他のコンポーネントを追加します。

例：`http://<host>:<port>/editor.html/content/experience-fragments/wknd/language-masters/en/contributors/stacey-roswells/master.html`

![ページ上のエクスペリエンスフラグメント](/help/sites-cloud/authoring/assets/xf-05.png)

## エクスペリエンスフラグメントのバリエーションの作成 {#creating-an-experience-fragment-variation}

必要に応じて、エクスペリエンスフラグメントのバリエーションを作成できます。

1. [編集する](#editing-your-experience-fragment)フラグメントを開きます。
1. 「**バリエーション**」タブを開きます。

   ![エクスペリエンスフラグメントのバリエーションの作成](/help/sites-cloud/authoring/assets/xf-06.png)

1. 「**作成**」では以下を作成できます。

   * **バリエーション**
   * **バリエーションをライブコピーとして**。

     >[!NOTE]
     >
     >初期バリエーションをライブコピーとして作成する場合、ライブコピーソースをプライマリバリエーションとして使用すると、タイトルが継承されます。

1. 必要なプロパティを定義します。

   * **テンプレート**
   * **タイトル**
   * **名前** - 空欄のままの場合、タイトルから派生されます
   * **説明**
   * **バリエーションのタグ**

   次に例を示します。

   ![バリエーションのプロパティ](/help/sites-cloud/authoring/assets/xf-07.png)


1. 「**完了**」で確定すると、新しいバリエーションがパネルに表示されます。

## エクスペリエンスフラグメントの使用 {#using-your-experience-fragment}

これで、ページをオーサリングする際に、エクスペリエンスフラグメントを使用できるようになりました。

1. 編集するページを開きます。

   >[!NOTE]
   >
   >ページは、編集可能なテンプレートに基づいている必要があります。

1. ページの段落システム内に、エクスペリエンスフラグメントコンポーネントのインスタンスを作成します。

1. 次のいずれかの方法で、実際のエクスペリエンスフラグメントをコンポーネントインスタンスに追加します。

   * アセットブラウザーから必要なフラグメントをドラッグして、コンポーネントにドロップします。
   * コンポーネントツールバーから&#x200B;**設定**&#x200B;を選択して、使用するフラグメントを指定し、「**完了**」で確定します。

   >[!NOTE]
   >
   >コンポーネントツールバーの「編集」は、フラグメントエディターでフラグメントを開くためのショートカットとして動作します。

例：`http://<host>:<port>/editor.html/content/wknd/language-masters/en/about-us.html`

![ページエディター内のエクスペリエンスフラグメント](/help/sites-cloud/authoring/assets/xf-08.png)

## 構築ブロック {#building-blocks}

1 つ以上のコンポーネントを選択して、フラグメント内で再利用するための構築ブロックを作成できます。

### 構築ブロックの作成 {#creating-a-building-block}

構築ブロックを作成するには、次の手順に従います。

1. エクスペリエンスフラグメントエディターで、再利用するコンポーネントを選択します。

   ![構築ブロック用コンポーネントの選択](/help/sites-cloud/authoring/assets/xf-09.png)

1. コンポーネントツールバーから、「**構築ブロックに変換**」を選択します。

   ![構築ブロックボタン](/help/sites-cloud/authoring/assets/xf-10.png)

1. **構築ブロック**&#x200B;の名前を入力して、「**変換**」で確定します。

   ![構築ブロック名の設定](/help/sites-cloud/authoring/assets/xf-11.png)

1. **構築ブロック**&#x200B;が左タブ（**ローカル**）に表示され、選択してさらにアクションを実行できます。

   ![パネル内の構築ブロック](/help/sites-cloud/authoring/assets/xf-12.png)

#### 構築ブロックの管理 {#managing-a-building-block}

構築ブロックは、「**構築ブロック**」タブに表示されます。各ブロックでは、次の操作を行えます。

* **マスターに移動**（ルートページバリエーションを新しいタブで開く）
* **名前を変更**
* **削除**

![構築ブロックの管理](/help/sites-cloud/authoring/assets/xf-13.png)

#### 構築ブロックの使用 {#using-a-building-block}

任意のコンポーネントと同様に、構築ブロックをフラグメントの段落システムにドラッグできます。

エクスペリエンスフラグメントを編集する際に、使用可能な構築ブロックが左側のタブに表示されます。次の条件でフィルタリングできます。

* **ローカル** - 現在のエクスペリエンスフラグメントの構築ブロック
* **すべて** - すべてのフラグメントの構築ブロック

![構築ブロックの選択](/help/sites-cloud/authoring/assets/xf-14.png)

## エクスペリエンスフラグメントのパーソナライズ機能 {#personalization-experience-fragment}

エクスペリエンスフラグメントのパーソナライズ機能を使用すると、マーケターはエクスペリエンスフラグメントのターゲットオーディエンスを 1 回だけ定義し、任意のページでフラグメントを再利用することができます。 この特徴は次のとおりです。

* フラグメントを使用するたびに、オーディエンスごとに必要なバリエーションを指定する必要がなくなります
* オファー全体のスタイル設定を維持します

この単一のフラグメント内にグループ化された複数のコンポーネントを含むエクスペリエンスフラグメントを作成することができます。 また、特定のオーディエンスセグメントごとにフラグメントのバリエーションを作成し、必要なチャネルでそれらのエクスペリエンスフラグメントを再利用することもできます。

パーソナライゼーションは、 エクスペリエンスフラグメントまたはバリエーション、またはフラグメントを含むフォルダーのいずれかで **パーソナライゼーション** プロパティを定義することによって実現されます。 これは継承することにより、パーソナライゼーションプロパティをオーバーライドできることを意味します。

これらのプロパティを設定すると、エクスペリエンスフラグメントエディターで&#x200B;**ターゲティング**&#x200B;モードを有効化することができます。

### エクスペリエンスフラグメントのパーソナライゼーションの定義 {#defining-personalization-experience-fragment}

フラグメントをパーソナライズするには：

1. **エクスペリエンスフラグメント**&#x200B;コンソール内の必要な場所に移動します。

1. フォルダーまたはフラグメントを選択し、さらにツールバーの&#x200B;**プロパティ**&#x200B;を選択します。

   >[!NOTE]
   >
   >フォルダーに定義されたパーソナライゼーションプロパティは、サブツリー下のすべての子フォルダーと、そのサブツリー内のエクスペリエンスフラグメント（およびバリエーション）に継承されます。継承を解除することで、上書きできます。

1. **パーソナライゼーション**&#x200B;タブをを開き、設定を定義して保存します。 例えば、フォルダーの場合：

   ![エクスペリエンスフラグメント - パーソナライゼーションプロパティ](/help/sites-cloud/authoring/assets/xf-personalization-properties.png)

   >[!CAUTION]
   >
   >フラグメントが Sites ページに埋め込まれている場合および&#x200B;**パーソナライゼーション**&#x200B;が設定されている場合、ページのレンダリング時には、ページのパーソナライゼーションバージョンのみが使用されます。
   >
   >フラグメント内のコンポーネントで実行されるターゲティングがページレンダリングで機能するには、次の条件を満たす必要があります。
   >
   >**パーソナライゼーション**&#x200B;タブで選択されたこの **ContextHub パス** は、次のいずれかである必要があります。
   >
   >* フラグメントがレンダリングされるページ用に設定されたパスと同じパス
   >
   >  または：
   >
   >* ページ用に設定された ContextHub で定義されたストアのサブセットを含むパス
   >
   >「**パーソナライゼーション**」タブで選択された&#x200B;**セグメントパス**&#x200B;は、次のいずれかである必要があります。
   >
   >* フラグメントがレンダリングされるページ用に設定されたパスと同じパス
   >
   >  または
   >
   >* ページ用に設定されたセグメントのサブセットを含むパス

### エクスペリエンスフラグメントのターゲティングの定義 {#defining-targeting-experience-fragment}

パーソナライゼーションプロパティを設定すると、フラグメントを編集用に開いた際に、ターゲティングモードを使用できるようになります。

![エクスペリエンスフラグメントエディター - ターゲティングモード](/help/sites-cloud/authoring/assets/xf-targeting-mode.png)

このモードは、ページ編集の場合と同じ方法で動作します。 詳しくは、[ページエディターのターゲティングモード](/help/sites-cloud/authoring/personalization/targeted-content.md)を参照してください。

## エクスペリエンスフラグメントの詳細 {#details-of-your-experience-fragment}

フラグメントの詳細は、以下のようにして確認できます。

1. エクスペリエンスフラグメントの場所に移動します（フラグメント内のバリエーションまで移動しないでください）。
詳細は、**エクスペリエンスフラグメント**&#x200B;コンソールのすべてのビューに表示されます。**リスト表示**&#x200B;には、[Adobe Target への書き出し](/help/sites-cloud/integrating/integrating-adobe-target.md)の詳細も含まれます。

   ![エクスペリエンスフラグメントの詳細](/help/sites-cloud/authoring/assets/xf-15.png)

1. エクスペリエンスフラグメントの&#x200B;**プロパティ**&#x200B;を開くと、

   ![「プロパティ」ボタン](/help/sites-cloud/authoring/assets/xf-16.png)

   プロパティが次のように様々なタブに表示されます。

   >[!CAUTION]
   >
   >これらのタブは、エクスペリエンスフラグメントコンソールから「**プロパティ**」を開くと表示されます。
   >
   >エクスペリエンスフラグメントの編集時に&#x200B;**プロパティを開く**&#x200B;と、適切な[ページのプロパティ](/help/sites-cloud/authoring/sites-console/page-properties.md)が表示されます。

   ![エクスペリエンスフラグメントのプロパティ](/help/sites-cloud/authoring/assets/xf-17.png)

   * **基本**
      * **タイトル**（必須）
      * **説明**
      * **タグ**
      * **バリアントの合計数** - 情報提供のみ
      * **Web バリアントの数** - 情報提供のみ
      * **非 Web バリアントの数** - 情報提供のみ
      * **このフラグメントを使用するページの数** - 情報提供のみ
   * **Cloud Services**
      * **クラウド設定**
      * **クラウドサービス設定**
      * **Facebook ページ ID**
      * **Pinterest ボード**
   * **参照**
      * 参照のリスト
   * **パーソナライズ機能**
      * **ContextHub のパス**
      * **セグメントのパス**
      * **ブランド**

## プレーン HTML レンディション {#the-plain-html-rendition}

URL の `.plain.` セレクターを使用すると、ブラウザーからプレーン HTML レンディションにアクセスできます。

>[!NOTE]
>
>ブラウザーから直接利用することもできますが、[主な目的は、他のアプリケーション（例えば、サードパーティ web アプリ、カスタムモバイル実装など）が、URL のみを使用して、エクスペリエンスフラグメントのコンテンツに直接アクセスできるようにすることです](/help/implementing/developing/extending/experience-fragments.md#the-plain-html-rendition)。

## エクスペリエンスフラグメントの公開 {#publishing-experience-fragments}

エクスペリエンスフラグメントの公開は、基本的に、[ページの公開](/help/sites-cloud/authoring/sites-console/publishing-pages.md)と同じです（エクスペリエンスフラグメントコンソールまたはエディターを使用）。

または、[プレビューに公開](/help/sites-cloud/authoring/sites-console/previewing-content.md)することもできます（同じく、エクスペリエンスフラグメントコンソールまたはエディターを使用）。

>[!CAUTION]
>
>デフォルトでは、エクスペリエンスフラグメントのルートフォルダー（`/content/experience-fragments` の直下）を公開すると、次のようになります。
>
>* コンテナフォルダー自体のみを公開します
>* 子は公開しません
>* 既に公開済みの子は非公開にされます
>
>フォルダー内のすべてのエクスペリエンスフラグメントを公開するには、それぞれを個別に公開する必要があります。

## エクスペリエンスフラグメントの書き出し {#exporting-experience-fragments}

デフォルトでは、エクスペリエンスフラグメントは HTML 形式で配信されます。AEM とサードパーティチャネルのどちらでも同じように使用できます。

Adobe Target に書き出す場合は、JSON を使用することもできます。以下を参照してください。

* [Adobe Target との統合](/help/sites-cloud/integrating/integrating-adobe-target.md)
* [Adobe Target へのエクスペリエンスフラグメントの書き出し](/help/sites-cloud/integrating/experience-fragments-target.md)
