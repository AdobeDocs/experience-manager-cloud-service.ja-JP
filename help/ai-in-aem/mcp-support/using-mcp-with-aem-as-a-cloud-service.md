---
title: AEM as a Cloud Serviceでの MCP の使用
description: AEM as a Cloud Serviceで Model Context Protocol を使用する方法を説明します
feature: Edge Delivery Services, Agentic AI
role: User, Admin, Architect, Developer
source-git-commit: 3ff5ef0be78f5f5a61c81c8ab0388b56fa134047
workflow-type: tm+mt
source-wordcount: '2016'
ht-degree: 0%

---


# AEM as a Cloud Serviceでの MCP の使用 {#using-mcp-with-aem-as-a-cloud-service}

## はじめに {#introduction}

現在、多くのAEM チームは、IDE や、Cursor、ChatGPT、Anthropic Claude、Microsoft Copilot Studio などのチャットベースのアプリケーションで作業しています。 これらのアプリケーションは、アプリケーションがバックエンドツールを標準化された方法で大規模な言語モデル（LLM）に公開できるようにするモデルコンテキストプロトコル（MCP）をサポートしています。

AEMの MCP 統合を使用すると、様々なペルソナが同じコンテンツを中心に共同作業を行うことができます。

* **開発者**、IDE またはチャットアプリケーションからコンテンツ操作やワークフローを調整できます
* **実務担当者** とコンテンツアーキテクトは、AEMの既存の権限モデル内に留まりながら、AI 支援を使用してサイト、コンテンツフラグメントおよびアセットを管理できます。

>[!IMPORTANT]
>
> AI アシスタントによって実行されるAEM エージェントには組み込みの保護機能が含まれているので、コンテンツを変更または削除するシナリオの場合、実務担当者は MCP ツールを直接呼び出すのではなく、AI アシスタント インターフェイスを使用する必要があります。
>

この記事では、AEMの MCP 機能の機能、サポートされている MCP アプリケーション、設定方法、実際の使用方法について説明します。

## MCP がAEMのお客様に役立つ理由 {#why-mcp-is-useful-for-aem-customers}

最新の IDE およびチャットアプリケーションは、MCP サーバーの背後に公開されているツールを LLM が呼び出す方法として MCP を使用します。 お客様は、低レベルの API 仕様に対応するコードを記述する代わりに、自然言語で意図を記述し（*「すべてのページでこのキャンペーンのヒーローバナーを更新」*）、LLM に適切な MCP ツールを呼び出させ、MCP ツールがAEMの API と連携するようにします。

主なメリットは次のとおりです。

* **API 給排水衛生設備配管の代わりの自然言語インタラクション**
MCP ツールは、使用可能な操作とその呼び出し方法を記述します。 LLM では、これらのスキーマを使用して、呼び出すツールと使用するパラメータを決定します。
* **アプリケーション間で一貫したエクスペリエンス**
複数の MCP 互換アプリケーションから同じAEM MCP ツールを使用できるので、同じAEMの基本機能を呼び出しながら、最も生産的な場所で作業できます。
* **安全とガバナンスの維持**
AEM MCP ツールへのリクエストは、認証済みユーザーの ID で実行され、各ツールによってユーザーの既存のAEM権限が適用されます。 AI を利用した操作は、AEMの手動操作と同じアクセスルールに従います。

## AEMが提供する MCP サーバー {#mcp-servers-provided-by-aem}

AEMは、MCP サーバーを HTTP エンドポイントとして公開します。 以下に示すエンドポイントは、以下に関連しています。

`https://mcp.adobeaemcloud.com/adobe/mcp/`

### MCP サーバー {#mcp-servers}

| **MCP サーバー** | **エンドポイント** | **説明** |
|---|---|----------------------------------------------------------------------------------------------------------------------|
| **コンテンツ** | `/content` | ページ、フラグメント、アセットの作成、読み取り、更新、削除（CRUD）を含む、すべての低レベルのコンテンツ操作。 |
| **コンテンツ （読み取り専用）** | `/content-readonly` | ページ、フラグメント、アセットの読み取り専用コンテンツ操作（Get、List/Search）。 |

各 MCP サーバーによって公開される特定のツールは、時間の経過と共に進化する可能性があります。 実際には、次のようなプロンプトを使用してツールを検出するように MCP 対応のアプリケーションに依頼できます。

*「このサーバーで使用可能なすべてのAEM MCP ツールを一覧表示し、それらの機能について説明します。」*

MCP クライアントは MCP プロトコルを使用してツール リストとスキーマを取得します。このスキーマは LLM で使用できます。

## サポートされる MCP アプリケーション {#supported-mcp-applications}

AEMの MCP サーバーは、MCP 互換アプリケーションの定義済みセットで動作するように設計されています。 次のアプリケーションがサポートされています。

* 人類的クロード
* カーソル
* OpenAI ChatGPT
* Microsoft コパイロット スタジオ

各アプリケーションは独自の設定エクスペリエンスを提供しますが、大まかな手順は似ています。

## 設定の概要 {#setup-overview}

AEMの MCP の設定には、主に次の 2 つの部分があります。

1. **各 MCP クライアントアプリケーションでの設定** これにより、アプリケーションはAEM MCP サーバーへの接続方法を把握し、OAuth ログインを実行できます。
1. **MCP サーバを選択** してからプロンプトを表示し、MCP クライアントが MCP サーバの使用を認識できるようにします。

### AEM の設定 {#aem-configuration}

デフォルトでは、AEMの MCP サーバーへのアクセスは、個々のユーザーがAEM内で持つ権限によって制御されます。 MCP クライアントアプリケーションを使用して認証を行う場合、MCP ツールはAEMでの手動操作と同じアクセスルールを適用します。 ユーザーが実行できるのは、既に実行を許可されているアクションのみです。

#### 許可された MCP クライアントアプリケーション {#permitted-mcp-client-applications}

次の MCP クライアントアプリケーションがデフォルトで許可されています。

* ChatGPT
* クロード
* MS コパイロット スタジオ
* カーソル

#### MCP サーバーの制限 {#restricting-mcp-servers}

すべての MCP サーバはデフォルトで許可リストに加えるされます。 管理者には、特定の MCP サーバーへのアクセスを組織、プログラム、環境レベルで制限するオプションがあります。 これにより、組織内のユーザーが使用できる MCP 機能を詳細に制御できます。

#### MCP クライアント・アクセスの管理 {#managing-mcp-client-access}

また、管理者は、組織のポリシーで必要とされる場合、特定の MCP クライアントアプリケーションのアクセスを無効にすることもできます。 Adobeで追加の MCP クライアント製品のサポートを有効にする場合は、製品の web サイトへのリンクを送信します。 カスタム MCP クライアントを許可リストに加えるする必要がある場合は、こちらにも問い合わせてください。

MCP サーバーに関するご要望は、**aemcs-mcp-feedback@adobe.comまでお気軽にお問い合わせください**

### MCP クライアントアプリケーションの設定 {#mcp-client-application-configuration}

この手順は、各ユーザーが実行します（または、サポートされている場合は、MCP クライアントアプリケーションの管理者が実行します）。 設定の詳細は、アプリケーションによって若干異なります。 MCP クライアントは急速に進化しており、リモート MCP サーバのサポートが積極的に開発されています。 リモートサーバーを追加する機能にアクセスするには、開発者モードを有効にする必要がある場合がありますが、通常のプロセスは次のとおりです。

1. AEM MCP サーバー URL を追加します。
   * 上の表から MCP エンドポイントを設定します。 次に例を示します。`https://mcp.adobeaemcloud.com/adobe/mcp/content-readonly`
1. 接続のトリガー
   * MCP クライアントアプリケーションがAEM MCP サーバーへの接続を試みるように、設定を保存またはアクティベートします
1. Adobe IDでログイン
   * プロンプトが表示されたら、Adobe ログインフローを実行し、Adobe IDに関連付けられた OAuth トークンをアプリケーションが取得できるようにします
1. 検出されたツールの検証
   * 認証されると、アプリケーションはサーバーから MCP ツールを検出します。 その後、LLM に対してAEM操作の実行を促すプロンプトを開始できます。

以下に、サポートされている各アプリケーションの概要を示す例を示します。

**ChatGPT**

![ChatGPT の設定手順 1](assets/chatgpt-1.png)

![ChatGPT の設定手順 2](assets/chatgpt-2.png)

![ChatGPT の設定手順 3](assets/chatgpt-3.png)

![ChatGPT の設定手順 4](assets/chatgpt-4.png)

![ChatGPT の設定手順 5](assets/chatgpt-5.png)

![ChatGPT の設定手順 6](assets/chatgpt-6.png)

![ChatGPT の設定手順 7](assets/chatgpt-7.png)

* AEM MCP サーバー URL を、MCP 接続またはツールが設定されている領域に追加します
* 接続をトリガーし、リダイレクトされたらAdobe IDでログインする
* チャットでは、プロンプトで設定済みのAEM ツールを参照します。例：

  *「設定済みのAEM MCP ツールを使用して、オーサー環境のすべてのサイトを一覧表示します。」*

**クロード**

![ クラウドの設定手順 1](assets/claude-1.png)

![ クラウドの設定手順 2](assets/claude-2.png)

![ クラウドの設定手順 3](assets/claude-3.png)

![ クラウドの設定手順 4](assets/claude-4.png)

![ クラウドの設定手順 5](assets/claude-5.png)

![ クラウドの設定手順 6](assets/claude-6.png)

![ クラウドの設定手順 7](assets/claude-7.png)

* Claude の MCP 設定で、AEM MCP サーバー URL を登録します
* Adobeのログインフローを完了する
* オプションで、設定領域で特定のツールの自動確認を有効にします。 これは、検索または読み取り専用操作に推奨されます。
* 会話を開始する前に、MCP サーバーが選択されていることを確認します
* Claude にAEM関連のタスクを実行するように依頼します。Claude は、プロンプトに基づいて、MCP サーバーによって公開されるAEM ツールを選択します。

**カーソル**

![ カーソルの設定手順 1](assets/cursor-1.png)

![ カーソルの設定手順 2](assets/cursor-2.png)

![ カーソルの設定手順 3](assets/cursor-3.png)

![ カーソルの設定手順 4](assets/cursor-4.png)

![ カーソルの設定手順 5](assets/cursor-5.png)

* Cursor の MCP settings で、AEMの MCP URL で新しい MCP サーバ エントリを作成します
* プロンプトが表示されたらAdobe IDで認証します
* 必要に応じて、ツール名をクリックして個々のツールを有効または無効にします。 デフォルトでは、すべてのツールが有効になっています。
* Cursor のエディターまたはチャットを使用して、開発ワークフローまたはコンテンツワークフローの一部としてAEM ツールを呼び出します。

**Microsoft コパイロット スタジオ**

![ コパイロットの設定手順 1](assets/copilot-1.png)

![ コパイロットの設定手順 2](assets/copilot-2.png)

![ コパイロットの設定手順 3](assets/copilot-3.png)

![ コパイロットの設定手順 4](assets/copilot-4.png)

![ コパイロットの設定手順 5](assets/copilot-5.png)

![ コパイロットの設定手順 6](assets/copilot-6.png)

![ コパイロットの設定手順 7](assets/copilot-7.png)

![ コパイロットの設定手順 8](assets/copilot-8.png)

![ コパイロットの設定手順 9](assets/copilot-9.png)

![ コパイロットの設定手順 10](assets/copilot-10.png)

* 新しいエージェントの作成
* ツールセクションに移動して、「**ツールを追加**」をクリックします。
* 既存のツールを選択するか、新しいツールを作成します
* AEM MCP サーバーの URL を指す新しい MCP ツールを設定します。
* エージェント間で共有または専用にできる接続の確立
* リダイレクトされたときにAdobe IDを使用してログイン
* オプションで、自動確認モードを有効にするか、すべてのツールインタラクションに対してエンドユーザーの確認を要求します
* エージェントをテストするときは、接続マネージャーを開いてセッションに接続を割り当ててから、**再試行** キーを押します。

## 認証 {#authentication}

Adobeでホストされる MCP サーバーは、OAuth を実装し、Adobeの ID システムと統合されています。

* MCP クライアントアプリケーションがAEM MCP サーバーに接続すると、Adobeのログインダイアログが表示され、**Adobe IDを使用して認証** 行われます。
* ログインに成功すると、システムは MCP クライアントアプリケーションが組織で許可され、リクエストされた MCP サーバーが許可されていることを確認します。 いずれかのチェックが失敗した場合は、エラーメッセージが表示されます。

![MCP Client not permitted エラー ](assets/MCP-Client-not-permitted.png)

* 検証が完了すると、MCP サーバーは、アプリケーションが後続のツール呼び出しに使用するトークンを発行します
* MCP ツールは、ユーザーのAEM権限を尊重します。 AEMのコンテンツフラグメントを変更する権限を持たないユーザーは、MCP を使用して変更することもできません。

これにより、AI を利用した操作が、既存のAEMのセキュリティおよびガバナンスモデルに確実に準拠するようになります。

## AEMでの MCP の使用 {#using-mcp-with-aem}

AEMと MCP クライアントアプリケーションが設定されたら、任意のアプリケーションで作業し、LLM にAEM操作を実行するように求めることができます。 LLM は、MCP ツール スキーマを読み取り、呼び出すツールを選択し、要求を満たすために必要に応じてシーケンスを実行します。

>[!IMPORTANT]
>
>最良の結果を得るには、特に複数のステップを含むプロンプトや、画像やテキストなどの異なるコンテンツタイプをターゲットにするプロンプトでは、自動モードに依存するのではなく、MCP クライアントで思考モデルを有効にするか、「思考」オプションを選択します。

### 使用例 {#example-usecases}

代表的なシナリオを次に示します。

* **環境の検出**
   * 環境とライセンスのリストを作成して、ワークフローの実行場所を決定します。

* **サイト管理**
   * サイトのリスト
   * ページおよびページコンテンツを作成、読み取り、更新、削除します。

* **コンテンツフラグメント管理**
   * コンテンツフラグメントを検索
   * フラグメントの新規作成
   * キャンペーンメッセージの変更時に既存のフラグメントを更新する。

* **Assetsの管理**
   * アセットの読み込み
   * 既存のアセットの検索
   * アセットの公開

### ワークフローの例 {#example-workflows}

次の例は、LLM が MCP ツールを連結する方法を示しています。

1. **ページによって参照されるコンテンツフラグメントの操作**
   * **ページコンテンツを取得** - `get-aem-page-content` などのツールを呼び出して、ページを取得し、`fragmentPath` プロパティを見つけます。
   * **フラグメントパスの解決** - `resolve_fragment_path` を使用して、パスを UUID に変換します。
   * **フラグメントデータを取得** - `get_fragment` を呼び出して、現在のフィールドを取得します。
   * **フラグメントの更新** - `patch_fragment` を呼び出して、フラグメントコンテンツに変更を適用します。
1. **モデルに基づく新しいコンテンツの作成**
   * **モデルの検出** - `list_models` を使用して、使用可能なコンテンツフラグメントモデルを確認します。
   * **モデルを検査** - `get_model` を使用してモデルのフィールドスキーマを理解します。
   * **コンテンツを作成** - プロンプトから派生した値を使用して新しいフラグメントを作成する場合は、`create_fragment` を使用します。
1. **既存コンテンツの安全な更新**
   * **現在のデータを読み取り** - `get_fragment` を使用して、既存のデータと ETag を取得します。
   * **JSON パッチを適用** - ETag および JSON パッチドキュメントと共に `patch_fragment` を使用して、フラグメントを更新し、楽観的同時実行をサポートします。

ユーザーの観点からは、次のようなプロンプトを使用してワークフローを開始できます。

*「ヒーローバナーモデルに基づいて spring キャンペーン用の新しいコンテンツフラグメントを作成し、この概要のフィールドに入力します。」*

LLM は、必要な MCP ツールを自動的に選択し、調整します。

## 期待管理 {#expectation-management}

MCP を使用して LLM を操作する場合は、次の点に注意してください。

* **能力は高いが確実ではない**
LLM は複雑なタスクを実行できますが、エラーが発生する可能性が高くなります。 同じプロンプトを使用すると、明らかな理由もなく、結果やプレゼンテーションが若干異なる場合があります。 実稼動コンテンツに変更を適用する前に、必ず出力を確認してください。

* **機能の進化**
LLM モデルは継続的に改善されています。 時間が経つにつれて、MCP ツールを組み合わせて目標を達成する新しい方法を発見する際に賢くなります。 今日、複数のプロンプトが必要なタスクは、明日、1 つのプロンプトでシームレスに動作する可能性があります。

* **人間による監督が不可欠**
LLM は、監視が必要な知識が豊富なアシスタントと考えてください。 幅広い知識があり、創造的なソリューションを考案できますが、ガイダンスとレビューからメリットを得ることができます。 結果を検証し（特に重要な操作の場合）、出力が期待に合わない場合はフィードバックを提供します。

* **ツールの実行を自動確認する場合は注意が必要**
Claude などの一部の MCP クライアント アプリケーションでは、LLM から要求されたツール実行を自動確認するオプションが提供されています。 コンテンツの検索や取得などの読み取り専用操作に便利ですが、コンテンツを更新または削除するツールには注意が必要です。 AEM環境を変更するアクションを確認する前に、各ツール実行リクエストを確認してください。

## 制限事項 {#limitations}

AEMの MCP サーバーは、現在、ChatGPT、Claude、Cursor、およびMicrosoft Copilot Studio で設定されることを想定しています。

別の MCP クライアントアプリケーションを使用する場合は、**aemcs-mcp-feedback@adobe.com** に問い合わせて、追加のクライアントのサポートをリクエストするか、カスタムクライアントを許可リストに加えるしてください。
